"use strict";(self.webpackChunk_nyx_discord_docs=self.webpackChunk_nyx_discord_docs||[]).push([[4629],{9412:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"error/error-handling","title":"\ud83d\udcab Error Handling","description":"In nyx, every executor holds an ErrorHandler, where errors thrown by middlewares and executed objects are handled.","source":"@site/docs/error/error-handling.mdx","sourceDirName":"error","slug":"/error/error-handling","permalink":"/nyx/docs/error/error-handling","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/error/error-handling.mdx","tags":[],"version":"current","frontMatter":{"title":"\ud83d\udcab Error Handling"},"sidebar":"nyxSidebar","previous":{"title":"\ud83d\udcd4 Session Repository","permalink":"/nyx/docs/features/sessions/session-repository"}}');var s=n(3159),t=n(5912);const a={title:"\ud83d\udcab Error Handling"},c=void 0,d={},l=[{value:"\ud83d\udd28 Manipulating consumers",id:"-manipulating-consumers",level:2},{value:"\u23ec Fallback consumer",id:"-fallback-consumer",level:2},{value:"\ud83d\udd0e Consumer resolution",id:"-consumer-resolution",level:2}];function i(e){const r={admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.p,{children:["In nyx, every executor holds an ",(0,s.jsx)(r.code,{children:"ErrorHandler"}),", where errors thrown by middlewares and executed objects are handled."]}),"\n",(0,s.jsxs)(r.p,{children:["An error handler behaves like a map of consumers, where the key is the error constructor (the class) and the value is an\n",(0,s.jsx)(r.code,{children:"ErrorConsumer"}),", which is a callback that receives the error, the object, the arguments that were used to call it\nand the bot."]}),"\n",(0,s.jsx)(r.h2,{id:"-manipulating-consumers",children:"\ud83d\udd28 Manipulating consumers"}),"\n",(0,s.jsxs)(r.p,{children:["To add a consumer, use ",(0,s.jsx)(r.code,{children:"ErrorHandler#setConsumer()"}),":"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"const errorHandler = bot.getCommandManager().getExecutor().getErrorHandler();\n\nerrorHandler.setConsumer(\n  MyError,\n  (\n    error: MyError,\n    command: ExecutableCommand<CommandData>,\n    args: CommandExecutionArgs,\n  ) => {\n    const [meta] = args;\n    const bot = meta.getBot(true);\n\n    const { name } = command.getData();\n\n    logger.error(\n      `MyError occurred while executing ${name} with args: ${args}`,\n      error\n    );\n  }\n);\n"})}),"\n",(0,s.jsxs)(r.p,{children:["To remove a consumer, use ",(0,s.jsx)(r.code,{children:"ErrorHandler#removeConsumer()"}),":"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"const errorHandler = bot.getCommandManager().getExecutor().getErrorHandler();\n\nerrorHandler.removeConsumer(MyError);\n"})}),"\n",(0,s.jsx)(r.h2,{id:"-fallback-consumer",children:"\u23ec Fallback consumer"}),"\n",(0,s.jsxs)(r.p,{children:["The ",(0,s.jsx)(r.code,{children:"ErrorHandler"})," has a fallback consumer, which is used if no consumer was found for a given error."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-ts",children:"const errorHandler = bot.getCommandManager().getExecutor().getErrorHandler();\n\nerrorHandler.setFallbackConsumer(\n  (\n    error: object,\n    command: ExecutableCommand<CommandData>,\n    args: CommandExecutionArgs,\n  ) => {\n    const [meta] = args;\n    const bot = meta.getBot(true);\n    const { name } = command.getData();\n\n    logger.error(\n      `An unhandled error occurred while executing ${name} with args: ${args}`,\n      error\n    );\n  }\n);\n"})}),"\n",(0,s.jsx)(r.h2,{id:"-consumer-resolution",children:"\ud83d\udd0e Consumer resolution"}),"\n",(0,s.jsxs)(r.p,{children:["The ",(0,s.jsx)(r.code,{children:"BasicErrorHandler"})," resolves a consumer based on the error prototype, going from the top to the bottom."]}),"\n",(0,s.jsx)(r.admonition,{type:"note",children:(0,s.jsxs)(r.p,{children:["For instance, if ",(0,s.jsx)(r.code,{children:"MyError2"})," extends ",(0,s.jsx)(r.code,{children:"MyError1"})," which extends ",(0,s.jsx)(r.code,{children:"MyError"}),", then it will first try to resolve the consumer\nfor ",(0,s.jsx)(r.code,{children:"MyError2"}),", then for ",(0,s.jsx)(r.code,{children:"MyError1"})," and finally for ",(0,s.jsx)(r.code,{children:"MyError"}),"."]})}),"\n",(0,s.jsxs)(r.p,{children:["If no consumer is found, the fallback consumer is used, whose error type is simply ",(0,s.jsx)(r.code,{children:"object"}),"."]})]})}function u(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(i,{...e})}):i(e)}},5912:(e,r,n)=>{n.d(r,{R:()=>a,x:()=>c});var o=n(1855);const s={},t=o.createContext(s);function a(e){const r=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),o.createElement(t.Provider,{value:r},e.children)}}}]);