"use strict";(self.webpackChunk_nyx_discord_docs=self.webpackChunk_nyx_discord_docs||[]).push([[372],{9576:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>l,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var i=s(7458),t=s(6436);const r={title:"\u26a1 Event Dispatcher"},c=void 0,a={id:"features/events/event-dispatcher",title:"\u26a1 Event Dispatcher",description:"The EventDispatcher is the object responsible for notifying subscribers about an event.",source:"@site/docs/features/events/event-dispatcher.mdx",sourceDirName:"features/events",slug:"/features/events/event-dispatcher",permalink:"/nyx/docs/features/events/event-dispatcher",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/features/events/event-dispatcher.mdx",tags:[],version:"current",frontMatter:{title:"\u26a1 Event Dispatcher"},sidebar:"nyxSidebar",previous:{title:"\ud83d\udce9 Event Subscribers",permalink:"/nyx/docs/features/events/event-subscriber"},next:{title:"\ud83d\udce3 Event Manager Event Bus",permalink:"/nyx/docs/features/events/event-manager-bus"}},o={},d=[{value:"\ud83d\udd02 Sync Dispatchers",id:"-sync-dispatchers",level:2},{value:"\u2705 Sync Advantages",id:"-sync-advantages",level:3},{value:"\u274c Sync Disadvantages",id:"-sync-disadvantages",level:3},{value:"\u23f0 Sync Timeout",id:"-sync-timeout",level:3},{value:"\ud83d\udd00 Async Dispatchers",id:"-async-dispatchers",level:2},{value:"\u2705 Async Advantages",id:"-async-advantages",level:3},{value:"\u274c Async Disadvantages",id:"-async-disadvantages",level:3},{value:"\ud83d\udccb Concurrency Limit",id:"-concurrency-limit",level:3},{value:"\ud83d\udea6 Middleware",id:"-middleware",level:2},{value:"\ud83d\udcab Error Handling",id:"-error-handling",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"EventDispatcher"})," is the object responsible for notifying subscribers about an event."]}),"\n",(0,i.jsxs)(n.p,{children:["They are used by the ",(0,i.jsx)(n.code,{children:"EventBus"}),", which passes to the dispatcher the subscribers and the arguments to use to notify them."]}),"\n",(0,i.jsx)(n.p,{children:"The dispatcher is then responsible that for each subscriber:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"EventSubscriberMiddlewareLinkedList"})," passes the execution."]}),"\n",(0,i.jsx)(n.li,{children:"The subscriber is executed with its respective arguments."}),"\n",(0,i.jsxs)(n.li,{children:["Any errors thrown by the subscriber or middleware are caught, wrapped if needed, and redirected to the ",(0,i.jsx)(n.code,{children:"ErrorHandler"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The main reason dispatchers are separated from the bus is because of the different ways subscribers can be called. Nyx\ntakes into account two ways: ",(0,i.jsx)(n.code,{children:"SyncEventDispatcher"})," and ",(0,i.jsx)(n.code,{children:"AsyncEventDispatcher"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["While ",(0,i.jsx)(n.code,{children:"nyx/core"})," declares sync and async dispatchers, the ",(0,i.jsx)(n.code,{children:"EventBus"})," in reality only depends in the ",(0,i.jsx)(n.code,{children:"EventDispatcher"}),"\ninterface, so it's not necessary for a custom dispatcher to use the sync or async version."]})}),"\n",(0,i.jsx)(n.h2,{id:"-sync-dispatchers",children:"\ud83d\udd02 Sync Dispatchers"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"SyncEventDispatcher"})," is a special type of dispatcher which calls its subscribers synchronously, meaning that it\nwaits for the current subscriber to finish before executing the next. Its ",(0,i.jsx)(n.code,{children:"@framework"})," implementation is the\n",(0,i.jsx)(n.code,{children:"BasicSyncEventDispatcher"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"-sync-advantages",children:"\u2705 Sync Advantages"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Synchronous execution ensures that subscribers are only executed in the order of their ",(0,i.jsx)(n.code,{children:"Priority"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Since synchronous execution waits for a subscriber to finish before moving on to the next one, it is easier to debug,\nas it is easier to trace where an error occurs."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-sync-disadvantages",children:"\u274c Sync Disadvantages"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Synchronous execution may be slower for events with many subscribers, as it has to wait for each subscriber (and its\nmiddleware) to finish before moving on to the next one. This can cause performance issues."}),"\n",(0,i.jsx)(n.li,{children:"If one subscriber takes a long time to execute, it can cause a delay in the entire system."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-sync-timeout",children:"\u23f0 Sync Timeout"}),"\n",(0,i.jsxs)(n.p,{children:["To tackle the mentioned disadvantages, the ",(0,i.jsx)(n.code,{children:"SyncEventDispatcher"}),' has a sync timeout functionality. This allows you to\nset "timeframe" for any subscriber to finish, before the dispatcher stops waiting and calls the next subscriber.']}),"\n",(0,i.jsxs)(n.p,{children:["This functionality can be turned off by setting it to ",(0,i.jsx)(n.code,{children:"null"})," via ",(0,i.jsx)(n.code,{children:"#setSyncTimeout()"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["The default sync timeout is of ",(0,i.jsx)(n.code,{children:"10000 ms"})," (10 seconds)."]})}),"\n",(0,i.jsx)(n.h2,{id:"-async-dispatchers",children:"\ud83d\udd00 Async Dispatchers"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"AsyncEventDispatcher"})," is a special type of dispatcher which calls its subscribers asynchronously, meaning that it\ndoesn't wait for the current subscriber to finish before executing the next. Its ",(0,i.jsx)(n.code,{children:"@framework"})," implementation is the\n",(0,i.jsx)(n.code,{children:"BasicAsyncEventDispatcher"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"-async-advantages",children:"\u2705 Async Advantages"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Asynchronous execution can be faster, especially for events with many subscribers, since it can execute them in\nparallel."}),"\n",(0,i.jsx)(n.li,{children:"Asynchronous execution is less prone to blocking or delaying the system, since it can move on to the next subscriber\nwhile the previous one is still executing."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-async-disadvantages",children:"\u274c Async Disadvantages"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Multiple subscribers running in parallel may hog the event loop and decrease performance."}),"\n",(0,i.jsxs)(n.li,{children:["May lead to calling subscribers in an order different than their priority, which can cause problems in scenarios where\nthe order of execution matters. For example, subscribers with ",(0,i.jsx)(n.code,{children:"PriorityEnum.Normal"})," may execute before subscribers with\n",(0,i.jsx)(n.code,{children:"PriorityEnum.High"})," have finished."]}),"\n",(0,i.jsx)(n.li,{children:"Since subscribers are executed in parallel, it can be harder to trace where an error occurs."}),"\n",(0,i.jsx)(n.li,{children:"Asynchronous execution may cause issues with subscribers that rely on the state of the system (such as the event\nhandling marking system), as they may not see the most up-to-date state when they execute."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-concurrency-limit",children:"\ud83d\udccb Concurrency Limit"}),"\n",(0,i.jsxs)(n.p,{children:["To tackle the mentioned disadvantages, the ",(0,i.jsx)(n.code,{children:"AsyncEventDispatcher"})," has a concurrency limit functionality. This allows you\nto set how many subscribers are being checked or executed at the same time."]}),"\n",(0,i.jsxs)(n.p,{children:["This functionality can be turned off by setting it to ",(0,i.jsx)(n.code,{children:"null"})," via ",(0,i.jsx)(n.code,{children:"#setConcurrencyLimit()"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Setting this limit to ",(0,i.jsx)(n.code,{children:"1"})," effectively turns the dispatcher into a ",(0,i.jsx)(n.code,{children:"SyncEventDispatcher"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["The default concurrency limit is ",(0,i.jsx)(n.code,{children:"3"}),"."]}),"\n"]})}),"\n",(0,i.jsx)(n.h2,{id:"-middleware",children:"\ud83d\udea6 Middleware"}),"\n",(0,i.jsxs)(n.p,{children:["The dispatcher stores an ",(0,i.jsx)(n.code,{children:"EventSubscriberMiddlewareLinkedList"})," that will either allow or deny the call of a given subscriber.\nThis list can be obtained via ",(0,i.jsx)(n.code,{children:"EventDispatcher#getMiddleware()"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["For information about how to use it, check the ",(0,i.jsx)(n.a,{href:"./event-interception",children:"\ufe0f\ud83d\udee1\ufe0f Event Interception"})," documentation."]}),"\n",(0,i.jsx)(n.h2,{id:"-error-handling",children:"\ud83d\udcab Error Handling"}),"\n",(0,i.jsxs)(n.p,{children:["The dispatcher stores an ",(0,i.jsx)(n.code,{children:"ErrorHandler"}),", which is redirected errors thrown by any subscriber. For information about how\nto use it, check the ",(0,i.jsx)(n.a,{href:"../../error/error-handling",children:"\ud83d\udcab Error Handling"})," documentation."]}),"\n",(0,i.jsx)(n.p,{children:"There are special errors that are redirected there however, specifically when checking the middleware. These are:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"EventSubscriberMiddlewareError"})," - Caused when a middleware throws an error, the list catches it and wraps it in this error. It's known which middleware caused the error."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"UncaughtEventSubscriberMiddlewareError"})," - Caused when the list throws an error, and it's not the one above. In theory, it should never happen but it still exists just in case. It's not known which middleware caused the error."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"These errors hold information useful to handle them, like the middleware that caused the error, or the entire list if the\nmiddleware is not known."})]})}function l(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},6436:(e,n,s)=>{s.d(n,{Z:()=>a,a:()=>c});var i=s(2983);const t={},r=i.createContext(t);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);